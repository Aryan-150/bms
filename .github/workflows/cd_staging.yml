name: Deploy to the bms-dev

on:
    push:
        branches: [ main ]

jobs:
    redeploy_everything:
        runs-on: ubuntu-latest
        steps:
            - name: Deploying everything to the bms-dev cluster
              run: |
                echo "${{ secrets.SSH_PRIVATE_KEY }}" &> ~/ssh_key
                mkdir /home/runner/.ssh
                ls /home/runner/.ssh
                touch /home/runner/.ssh/known_hosts
                echo "${{ secrets.KNOWN_HOSTS }}" &> /home/runner/.ssh/known_hosts 
                chmod 700 /home/runner/ssh_key
                ssh -i ~/ssh_key ubuntu@15.206.195.188 -t "cd bms"

